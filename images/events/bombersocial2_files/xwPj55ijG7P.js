/*!CK:2900636315!*//*1414378765,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["W416x"]); }

__d("WindowComm",["URI"],function(a,b,c,d,e,f,g){var h={_callbacks:{},makeHandler:function(i,j,k){j=j||'opener';if(!k)k='f'+(Math.random()*(1<<30)).toString(16).replace('.','');h._callbacks[k]=i;return new g('/connect/window_comm.php').setQueryData({_id:k,_relation:j}).getQualifiedURI().toString();},_recv:function(i){var j=new g(i).getQueryData();h._callbacks[j._id](j);}};e.exports=h;a.WindowComm=h;},null);
__d("OpenIDRequest",["AsyncRequest","AsyncSignal","URI","UserAgent_DEPRECATED","PHPQuerySerializer","coalesce","copyProperties","createArrayFrom"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){var p=new g().setReadOnly(true).setHandler(this.asyncResponseHandler.bind(this)).setErrorHandler(this.asyncErrorHandler.bind(this));m(this,{openidUrl:null,requestId:o.maxRequestId++,successResponseHandler:null,cancelHandler:null,intermediateHandler:null,immediateMode:false,useExtensions:true,thirdPartyLogin:false,popupWindow:null,asyncRequest:p,retryCount:0});o.requests[this.requestId]=this;}o.getRequestById=function(p){return o.requests[p];};o.prototype.setOpenIDUrl=function(p){this.openidUrl=p;return this;};o.prototype.setSuccessHandler=function(p){this.successResponseHandler=p;return this;};o.prototype.setErrorHandler=function(p){this.errorHandler=p;return this;};o.prototype.setCancelHandler=function(p){this.cancelHandler=p;return this;};o.prototype.setImmediateMode=function(p){this.immediateMode=p;return this;};o.prototype.setUseExtensions=function(p){this.useExtensions=p;return this;};o.prototype.setIntermediateHandler=function(p){this.intermediateHandler=p;return this;};o.prototype.setThirdPartyLogin=function(p){this.thirdPartyLogin=p;return this;};o.prototype.send=function(){if(!this.openidUrl)throw "openidUrl is a required parameter. Call setOpenIDUrl()";var p=this.calculateRedirectUrl();if(!p){this.logMetrics('redirectUrlNotFound');return;}if(this.immediateMode){this.createHiddenIframe(p);}else{if(this.popupWindow)throw "OpenID popup is already in progress";this.showPopup(p);}this.logMetrics('requestSent');};o.prototype.calculateRedirectUrl=function(p){var q=this.immediateMode?'checkid_immediate':'checkid_setup',r={'openid.mode':q},s;if(!o.cache[this.openidUrl])return null;s=o.cache[this.openidUrl].url;var t=i(i(s).getQueryData()['openid.return_to']);t.addQueryData({context:o.context,request_id:this.requestId});r['openid.return_to']=t.toString();r.third_party_login=this.thirdPartyLogin;return i(s).addQueryData(r).getQualifiedURI();};o.prototype.createHiddenIframe=function(p){var q='openid_request_'+this.requestId,r=document.body.appendChild(document.createElement('div')),s=function(){r.innerHTML=('<iframe name="'+q+'"'+' src="'+p.toString()+'"'+' scrolling="no" '+' frameborder="0" class="hidden_elem"></iframe>');};if(j.ie()){r.innerHTML='<iframe src="javascript:false"></iframe>';setTimeout(s,0);}else s();};o.prototype.showPopup=function(p){var q;if(o.cache[this.openidUrl])q=o.cache[this.openidUrl].popup_dimensions;if(!q||!q.height||!q.width)q={height:'580',width:'790'};var r={x:l(window.screenX,window.screenLeft),y:l(window.screenY,window.screenTop),width:l(window.outerWidth,document.body.clientWidth),height:l(window.outerHeight,document.body.clientHeight)},s=r.x+((r.width-q.width)/2),t=r.y+((r.height-q.height)/2),u=["location=yes","scrollbars=1","left="+s,"top="+t,"resizable=yes","height="+q.height,"width="+q.width].join(",");this.popupWindow=window.open(p.toString(),'_blank',u);this.popupPollInterval=setInterval(this.pollPopupWindow.bind(this),100);this.popupWindow.focus();};o.prototype.pollPopupWindow=function(){if(!(this.popupPollInterval&&this.popupWindow))return;if(this.popupWindow.closed){clearInterval(this.popupPollInterval);this.cancel();}};o.prototype.closePopupIfOpen=function(){if(this.popupWindow){if(this.popupPollInterval)clearInterval(this.popupPollInterval);this.popupWindow.close();}this.popupWindow=null;};o.prototype.cancel=function(){this.closePopupIfOpen();if(this.cancelHandler)this.cancelHandler();this.logMetrics('requestCanceled');};o.prototype.logMetrics=function(p){new h('/ajax/openid/metrics.php',{metric:p,immediate:this.immediateMode,context:o.context,openid_url:this.openidUrl}).send();};o.prototype.triggerCompleteAuthAsync=function(p){if(p.charAt(0)=='?'||p.charAt(0)=='&')p=p.substr(1);var q=k.deserialize(p);this.closePopupIfOpen();if(q['openid.mode']=='cancel'){this.cancel();return;}if(this.intermediateHandler)this.intermediateHandler();this.asyncRequest.setData({openid_params:q}).send();};o.prototype.asyncResponseHandler=function(p){var q=p.getPayload();if(this.successResponseHandler)this.successResponseHandler(q);this.closePopupIfOpen();};o.prototype.cleanHandleResponse=function(p){if(p.css)p.css=n(p.css);this.asyncRequest.handleResponse(p);};o.prototype.asyncErrorHandler=function(p){this.closePopupIfOpen();if(p.error==1428010||p.error==1428011){this.cancel();return;}if(this.errorHandler)this.errorHandler(p);};o.prototype.retry=function(){++this.retryCount;this.requestId=o.maxRequestId++;this.send();};o.prototype.setProviderCache=function(p){o.cache=p;return this;};o.cache={};o.requests=[];o.maxRequestId=0;o.context='default';e.exports=o;},null);
__d("WidgetArbiter",["createArrayFrom"],function(a,b,c,d,e,f,g){var h={_findSiblings:function(){if(h._siblings)return;h._siblings=[];for(var i=parent.frames.length-1;i>=0;i--)try{if(parent.frames[i]&&parent.frames[i].Arbiter&&parent.frames[i].Arbiter.inform)h._siblings.push(parent.frames[i].Arbiter);}catch(j){}},inform:function(){h._findSiblings();var i=g(arguments);h._siblings.forEach(function(j){j.inform.apply(j,i);});}};e.exports=h;},null);
__d("CommentAdminPanelController",["Arbiter","AsyncRequest","Button","ChannelConstants","CSS","DOM","Event","Toggler","URI","Vector","$","copyProperties","ge","startsWith","XD","MultiLoginPopup"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b('XD').UnverifiedXD,v=function(w){r(this,{locale:w.locale,channel:w.channel,controllerID:w.controllerID,commentIDs:w.commentIDs,domIDs:w.domIDs,duplicateComments:[],fetchMoreCommentsIsPending:{},blacklistedActors:w.blacklistedActors,actorToCommentInfoMap:w.actorToCommentIDMap,commentInfoMap:w.commentInfoMap,inAggregatedView:w.inAggregatedView,inModerationQueue:w.inModerationQueue,inContextualDialog:w.inContextualDialog,isTopLevelCommentPollingEnabled:false,loggedIn:w.loggedIn,newestCommentTimestamp:w.newestCommentTimestamp,realTimePollingParams:{},userOwnsPages:w.userOwnsPages,recentlyBlacklistedActors:w.blacklistedActors});g.subscribe(j.getArbiterType('comments_plugin_new_post'),function(x,y){if(y.obj.target===this.realTimePollingParams.target){if(s(y.obj.comment_element_id))return;var z=r({},this.realTimePollingParams);z.post_fbid=y.obj.post_fbid;var aa=y.obj.parent_comment_id;if(aa){var ba=s(aa);if(!ba)return;var ca=l.scry(ba,'.fbFeedbackPager.uiMorePager');if(ca.length>0)return;z.parent_comment_id=aa;z.is_reply_thread=true;}else{if(!this.isTopLevelCommentPollingEnabled)return;z.is_reply_thread=false;}this.pollForComments(z);}}.bind(this));this.controlledRegion=q(this.controllerID);this.attachClickHandlers();if(this.inModerationQueue)this.registerModeratorQueueHandlers(true);if(!this.inAggregatedView)u.init({autoResize:true,channelUrl:w.channel,hideOverflow:true,resizeWidth:false});};r(v,{allControllers:{},mainController:null,contextualControllers:{},initController:function(w){var x=new v(w),y=w.controllerID;v.allControllers[y]=x;if(x.inContextualDialog){v.contextualControllers[y]=x;}else v.mainController=x;},syncController:function(w,x){var y=v.allControllers[w];y.attachClickHandlers();if(!y.isControllingModerationQueue())return;y.deselectComments(x);y.registerModeratorQueueHandlers(false);y.synchronizeModeratorQueueUI();},resetController:function(w){var x=v.allControllers[w];x.resetController();},appendComments:function(w,x,y){var z=v.allControllers[w];z.appendComments(x,y);},prependComments:function(w,x,y){var z=v.allControllers[w];z.prependComments(x,y);},updateController:function(w,x,y,z,aa,ba,ca){var da=v.allControllers[w];da.updateController(x,y,z,aa,ba,ca);if(!v.mainController.loggedIn)b('MultiLoginPopup').reattachLoginInterceptors();if(!da.isControllingModerationQueue())return;da.registerModeratorQueueHandlers(false);da.synchronizeModeratorQueueUI();},updatePollingParamsCommentas:function(w,x){var y=v.allControllers[w];y.updatePollingParamsCommentas(x);},registerMoreCommentsLinkHandler:function(w,x){var y=v.allControllers[w];y.registerMoreCommentsLinkHandler(x);},replaceContentMaybe:function(w,x){var y=l.scry(document.documentElement,w)[0];if(y)l.replace(y,x);},notifyCommentCreated:function(w){if(!v.mainController.channel)return;u.send({type:'commentCreated',href:w.href,parentCommentID:w.parentCommentID,commentID:w.commentID,message:w.message});},notifyCommentRemoved:function(w){if(!v.mainController.channel)return;u.send({type:'commentRemoved',href:w.href,commentID:w.commentID});},markAsShowingAllReplies:function(w){var x=w+' a.fbUpDownVoteOption',y=l.scry(document.documentElement,x),z=w+' li.fbUpDownVoteOption a.itemAnchor',aa=l.scry(document.documentElement,z),ba=y.concat(aa);for(var ca=0;ca<ba.length;ca++){var da=ba[ca],ea=new o(da.getAttribute('ajaxify'));ea.addQueryData({show_all_replies:1});da.setAttribute('ajaxify',ea.toString());}},setLoggedIn:function(w){v.mainController.loggedIn=w;},blacklistChangeListener:function(w,x,y){var z=q(x);m.listen(w,'change',function(){if(w.options[w.selectedIndex].value==y){k.show(z);}else k.hide(z);});}});r(v.prototype,{isControllingModerationQueue:function(){var w=this==v.mainController&&this.inModerationQueue;return w;},resetController:function(){this.commentIDs=[];this.domIDs=[];},updateController:function(w,x,y,z,aa,ba){w.forEach(function(da){this.commentIDs.push(da);},this);x.forEach(function(da){this.domIDs.push(da);},this);r(this.blacklistedActors,z);for(var ca in aa){if(!this.actorToCommentInfoMap[ca])this.actorToCommentInfoMap[ca]=[];aa[ca].forEach(function(da){this.actorToCommentInfoMap[ca].push(da);},this);}this.newestCommentTimestamp=Math.max(this.newestCommentTimestamp,y);r(this.commentInfoMap,ba);this.attachClickHandlers();},updatePollingParamsCommentas:function(w){this.realTimePollingParams.commentas=w;},attachClickHandlers:function(){for(var w=0;w<this.domIDs.length;w++){var x='li[id="'+this.domIDs[w]+'"]',y=l.scry(this.controlledRegion,x);if(y.length===0)continue;var z=y[0],aa=l.scry(z,'a.uiCloseButton');m.listen(z,'mouseleave',this.closeStickyMenuFlyouts.bind(this,aa));var ba=l.scry(z,'.fbModerateDropdownContainer');if(ba.length>0){var ca=ba[0],da=l.find(ca,'.fbModerateDropdownLink');m.listen(da,'mouseover',function(ma,event){k.addClass(ma,'fbUnderlineText');}.bind(null,da));m.listen(da,'mouseout',function(ma,event){k.removeClass(ma,'fbUnderlineText');}.bind(null,da));var ea=l.find(ca,'.fbModerationDropdownList');m.listen(da,'click',this.exposeDropDownMenu.bind(this,da,ea));m.listen(ea.parentNode,'mouseleave',this.concealDropDownMenu.bind(this,da,ea));this.attachDropDownHandlers(z,this.commentIDs[w],ea);}var fa=this.commentInfoMap[this.commentIDs[w]].actor,ga=!!this.recentlyBlacklistedActors[fa];if(ga){var ha=l.scry(z,'.fbUndoBlacklistLink');if(ha.length>0){var ia=ha[0];m.listen(ia,'click',this.toggleBlackListAndSync.bind(this,this.commentIDs[w]));}}}var ja=l.scry(this.controlledRegion,'.fbReplyButton'),ka=l.scry(this.controlledRegion,'.fbReplyAfterLoginButton');for(var la=0;la<ja.length;la++)if(this.loggedIn){k.show(ja[la]);k.hide(ka[la]);}else{k.hide(ja[la]);k.show(ka[la]);}},closeStickyMenuFlyouts:function(w,event){n.hide();for(var x=0;x<w.length;x++)w[x].blur();},attachDropDownHandlers:function(w,x,y){var z=l.scry(y,'.fbBanUser');if(z.length>0){var aa=z[0],ba=l.find(aa,'^.fbFeedbackPost');if(t(ba.id,x))m.listen(aa,'click',this.toggleBlackListAndSync.bind(this,x));}},exposeDropDownMenu:function(w,x,event){if(k.shown(x))return this.concealDropDownMenu(w,x,event);m.stop(event);k.show(x);x.focus();w.blur();var y=l.find(document.documentElement,'.commentContent'),z=p.getElementPosition(x).y+p.getElementDimensions(x).y-p.getElementDimensions(y).y;if(z>0){z=z+2;this.menuBuffer=l.create('div',{className:'menuBuffer',style:{height:z+'px'}});l.appendContent(y,this.menuBuffer);}return false;},concealDropDownMenu:function(w,x,event){m.stop(event);k.removeClass(w,'fbUnderlineText');k.hide(x);w.blur();if(this.menuBuffer){l.remove(this.menuBuffer);delete this.menuBuffer;}return false;},registerMoreCommentsLinkHandler:function(w){var x=w.pager_id;if(!s(x))return;var y=q(x);m.listen(y,'click',this.fetchMoreComments.bind(this,w,y));},deselectComments:function(w){for(var x=0;x<w.length;x++)delete this.selectedCommentsMap[w[x]];},registerModeratorQueueHandlers:function(w){if(w)this.selectedCommentsMap={};this.selectableComments=this.findSelectableComments();this.selectableCheckboxes=[];this.selectAllCheckBoxes=l.scry(this.controlledRegion,'.fbSelectAllCheckbox');this.approveButtons=l.scry(this.controlledRegion,'.fbApproveButton');this.removeButtons=l.scry(this.controlledRegion,'.fbRemoveButton');for(var x=0;x<this.selectableComments.length;x++){var y=this.selectableComments[x].id,z=!!this.selectedCommentsMap[y];this.setCommentSelection(this.selectableComments[x],z);var aa=l.find(this.selectableComments[x],'.fbCommentCheckbox');m.listen(aa,'click',this.toggleCommentSelection.bind(this));m.listen(this.selectableComments[x],'click',this.toggleCommentSelection.bind(this));aa.checked=z;this.selectableCheckboxes.push(aa);}for(var ba=0;ba<this.selectAllCheckBoxes.length;ba++){this.selectAllCheckBoxes[ba].checked=false;this.selectAllCheckBoxes[ba].disabled=this.selectableComments.length===0;m.listen(this.selectAllCheckBoxes[ba],'click',this.toggleSelectAllCheckbox.bind(this,this.selectAllCheckBoxes[ba]));}for(var ca=0;ca<this.approveButtons.length;ca++)m.listen(this.approveButtons[ca],'click',this.setBulkPrivacy.bind(this,false));for(var da=0;da<this.removeButtons.length;da++)m.listen(this.removeButtons[da],'click',this.setBulkPrivacy.bind(this,true));},findSelectableComments:function(){var w=l.scry(this.controlledRegion,'.fbTopLevelComment'),x=[];for(var y=0;y<w.length;y++)if((l.scry(w[y],'.fbCommentCheckbox').length===1)&&(l.scry(w[y],'.fbCommentOverlay').length===0))x.push(w[y]);return x;},toggleCommentSelection:function(event){var w={a:true},x=event.getTarget(),y=x.tagName.toLowerCase(),z=x.parentNode.tagName.toLowerCase();if(w[y]||w[z])return;var aa=k.hasClass(x,'fbFeedbackPost')?x:l.find(x,'^.fbFeedbackPost'),ba=this.commentIsSelected(aa),ca=!ba;this.setCommentSelection(aa,ca);this.synchronizeModeratorQueueUI();if(k.hasClass(x,'fbCommentCheckbox'))m.stop(event);},commentIsSelected:function(w){return k.hasClass(w,'fbCommentSelected');},setCommentSelection:function(w,x){if(x){this.selectComment(w);}else this.deselectComment(w);},selectComment:function(w){k.addClass(w,'fbCommentSelected');this.selectedCommentsMap[w.id]=true;l.find(w,'.fbCommentCheckbox').checked=true;},deselectComment:function(w){k.removeClass(w,'fbCommentSelected');delete this.selectedCommentsMap[w.id];l.find(w,'.fbCommentCheckbox').checked=false;},toggleSelectAllCheckbox:function(w,event){m.stop(event);var x=w.checked;for(var y=0;y<this.selectableComments.length;y++){this.setCommentSelection(this.selectableComments[y],w.checked);this.selectableCheckboxes[y].checked=x;}this.synchronizeBulkModerationCheckboxes(x);this.synchronizeBulkModerationButtons(x);},synchronizeModeratorQueueUI:function(){var w=0;for(var x=0;x<this.selectableCheckboxes.length;x++)if(this.selectableCheckboxes[x].checked)w++;var y=this.selectableCheckboxes.length>0&&w==this.selectableCheckboxes.length;this.synchronizeBulkModerationCheckboxes(y);this.synchronizeBulkModerationButtons(w>0);},synchronizeBulkModerationCheckboxes:function(w){for(var x=0;x<this.selectAllCheckBoxes.length;x++)this.selectAllCheckBoxes[x].checked=w;},synchronizeBulkModerationButtons:function(w){for(var x=0;x<this.approveButtons.length;x++)i.setEnabled(this.approveButtons[x],w);for(var y=0;y<this.removeButtons.length;y++)i.setEnabled(this.removeButtons[y],w);},setBulkPrivacy:function(w,event){m.stop(event);this.synchronizeBulkModerationButtons(false);var x=[];for(var y in this.selectedCommentsMap)x.push(y);var z={is_private:w,in_moderation_queue:true,comment_ids:x,uniqids:x,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new h().setURI('/ajax/connect/comments/set_bulk_private.php').setData(z).send();return false;},toggleBlackListAndSync:function(w,event){m.stop(event);var x=this.commentInfoMap[w].actor,y={blacklist:!this.blacklistedActors[x],in_moderation_queue:this.inModerationQueue,comment_id:w,other_comment_ids:this.getOtherCommentsByActor(x,w),uniqid:w,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new h().setURI('/ajax/connect/comments/set_blacklist.php').setData(y).setHandler(function(z){this.blacklistedActors[x]=!this.blacklistedActors[x];if(this.blacklistedActors[x]){this.recentlyBlacklistedActors[x]=true;}else delete this.recentlyBlacklistedActors[x];}.bind(this)).send();return false;},getOtherCommentsByActor:function(w,x){return this.actorToCommentInfoMap[w].filter(function(y){return y!=x;});},fetchMoreComments:function(w,x,event){m.kill(event);k.addClass(x,'async_saving');if(this.fetchMoreCommentsIsPending[w.pager_id]===true)return;this.fetchMoreCommentsIsPending[w.pager_id]=true;var y={is_reply_thread:false,in_moderation_queue:false,view_as_moderator:false};r(y,w);var z=l.scry(q(y.controller_id),this.getCommentsSelector(y));z=z.concat(l.scry(q(y.controller_id),this.getCollapsedCommentsSelector(y)));var aa=0,ba=0;for(var ca=0;ca<z.length;ca++)if(!k.hasClass(z[ca],'fbCommentIgnored'))if(k.hasClass(z[ca],'fbCommentHidden')){ba++;}else aa++;if(y.is_reply_thread)y.offset=aa;y.hidden_offset=ba;if(!y.aggregate_view)delete y.aggregate_view;if(!y.comment_id)delete y.comment_id;if(!y.is_reply_thread)y.comment_ids=this.commentIDs;if(!y.commentas){var da=v.allControllers[y.controller_id];y.commentas=da.realTimePollingParams.commentas;}new h().setURI('/ajax/connect/feedback.php').setReadOnly(true).setData(y).setHandler(function(ea){this.fetchMoreCommentsIsPending[w.pager_id]=false;}.bind(this)).send();},getCommentsSelector:function(w){var x=w.is_reply_thread?'li.fbCommentReply':'li.fbTopLevelComment';if(w.controller_id!=w.uniqid)x='div[id="'+w.uniqid+'"] '+x;return x;},getCollapsedCommentsSelector:function(w){var x=w.is_reply_thread?'div.fbCommentReply':'div.fbTopLevelComment';if(w.controller_id!=w.uniqid)x='div[id="'+w.uniqid+'"] '+x;return x;},getRecentlyBlacklistedActors:function(){var w=[];for(var x in this.recentlyBlacklistedActors)w.push(x);return w;},appendComments:function(w,x){var y=s(w);if(!y)return;var z=l.scry(y,'.fbFeedbackReplies')[0];if(!z)return;l.appendContent(z,x);},prependComments:function(w,x){var y=l.scry(document.documentElement,w)[0];if(!y)return;var z=x.getNodes(),aa=[];for(var ba=z.length;ba-->0;){var ca={id:l.getID(z[ba]),element:z[ba]};aa.push(ca);var da=s(ca.id);if(da){k.hide(ca.element);this.duplicateComments.push(ca.element);for(var ea=0;ea<aa.length;++ea)l.insertAfter(da,aa[ea].element);aa=[];}}for(ba=0;ba<aa.length;++ba)l.prependContent(y,aa[ba].element);setTimeout(this.removeDuplicateComments.bind(this),0);},removeDuplicateComments:function(){for(var w=0;w<this.duplicateComments.length;++w)l.remove(this.duplicateComments[w]);this.duplicateComments=[];},pollForComments:function(w){var x={locale:this.locale};r(x,w);if(!x.is_reply_thread)x.comment_ids=this.commentIDs;x.newest_comment_timestamp=this.newestCommentTimestamp;var y=this.handlePollResponse.bind(this),z=this.handlePollError.bind(this),aa=this.handlePollFinally.bind(this);new h().setURI('/plugins/comments/poll').setReadOnly(true).setData(x).setMethod('GET').setHandler(y).setErrorHandler(z).setFinallyHandler(aa).send();},handlePollResponse:function(w){},handlePollError:function(w){},handlePollFinally:function(w){}});e.exports=window.CommentAdminPanelController||v;},null);
__d("legacy:developer-comments-js",["CommentAdminPanelController"],function(a,b,c,d){a.CommentAdminPanelController=b('CommentAdminPanelController');},3);
__d("ConnectLogin",["PopupWindow","URI","WindowComm","XD"],function(a,b,c,d,e,f,g,h,i){var j=b('XD').XD,k={init:function(l){this.appID=l.appID;this.addToProfile=l.addToProfile;this.channelUrl=l.channelUrl;j.init(l);},login:function(l,m,n){this._openPopup(l,m,n);},logout:function(){j.send({type:'logout'});},_openPopup:function(l,m,n){n=n||{};var o=i.makeHandler(function(s){k._closePopup();if(k.appID)k._refreshLoginStatus();l&&l();}),p=i.makeHandler(function(s){k._closePopup();}),q=new h('/login.php');q.setQueryData({api_key:this.appID,next:o,channel_url:p,cancel_url:p,req_perms:m,v:'1.0',fbconnect:1,add_to_profile:this.addToProfile,display:'popup'});q.addQueryData(n);var r=this._getSize(n);this._popup=g.open(q.toString(),r.height,r.width);},_closePopup:function(){if(this._popup){this._popup.close();this._popup=null;}},_refreshLoginStatus:function(){if(this.channelUrl){j.send({type:'refreshLoginStatus'});}else window.location.reload();},_getSize:function(l){if(l.social_plugin=='registration'){return {width:640,height:370};}else return {width:610,height:280};}};e.exports=k;},null);
__d("PlatformOptInPopup",["PopupWindow","URI","copyProperties"],function(a,b,c,d,e,f,g,h,i){var j=function(){};i(j,{DIALOG_URL:'/connect/uiserver.php',DIALOG_WIDTH:420,DIALOG_HEIGHT:450,APP_ID:127760087237610,open:function(k,l,m){if(!k)k='generic';if(!l)l='plugin.optin';var n=new h(j.DIALOG_URL);n.addQueryData({social_plugin:k,method:l,display:'popup',secure:h.getRequestURI().isSecure(),app_id:j.APP_ID});if(m)n.addQueryData(m);return g.open(n.toString(),j.DIALOG_WIDTH,j.DIALOG_HEIGHT);}});e.exports=j;},null);
__d("Feedback",["AsyncRequest","CSS","Dialog","DOM","Event","Input","LegacyContextualDialog","MentionsInput","Parent","PlatformOptInPopup","Style","Vector","$","ge","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v={comments:{},registerComment:function(w,x){v.comments[w]=x;return v;},getRegisteredComment:function(w){return v.comments[w];},deleteClickHandler:function(w,x,y,z,aa,ba){var ca=new i().setTitle("Delete post?").setBody("Are you sure you want to delete this post?").setButtons([i.newButton('delete',"Delete"),i.CANCEL]).setHandler(function(event){new g().setURI('/ajax/connect/feedback.php').setData({command:'delete',url:w,uniqid:z,owns_pages:aa,controller_id:y,locale:ba,comment_id:x}).send();}.bind(this)).show();},attachAddCommentListener:function(w,x){var y=s(w);k.listen(y,'click',function(){var z=s(x);h.removeClass(z,'hidden_elem');j.find(z,'textarea').focus();h.addClass(y,'hidden_elem');v.resizeCommentas(z);return false;});},resizeCommentas:function(w){var x=j.scry(w,'div.post')[0];if(x){var y=r.getElementDimensions(x).x;if(y){var z=j.find(x,'.commentas'),aa=r.getElementDimensions(z).x;if((y-aa)<190&&(y-190)>60){q.set(z,'width',y-190+'px');var ba=j.scry(z,'span.commentas_inner')[0];if(ba){var ca=r.getElementDimensions(ba).x;q.set(z,'width',ca+'px');}}}}},exposeContextualDialogReply:function(w){var x=s(w),y=x.parentNode.parentNode;h.show(j.find(y,"form.composerReply"));j.find(y,"textarea").focus();return false;},concealContextualDialogReply:function(w){var x=s(w),y=x.parentNode.parentNode,z=j.find(y,"form"),aa=j.find(y,"textarea"),ba=aa.value.length;if(!l.getValue(aa))h.hide(z);return false;},closeContextualDialog:function(w){var x=m.getInstance(s(w));x.hide();return false;},_clickLocked:false,attachOptInClickListener:function(w){k.listen(w,'click',function(x){k.kill(x);if(!this._clickLocked){this._clickLocked=true;setTimeout(function(){this._clickLocked=false;}.bind(this),1000);p.open('feedback','plugin.optin');}});},attachReplyListener:function(w){var x=t(w);if(!x)return;var y=j.find(x,'textarea');x.suppressBlur=false;k.listen(x,'click',function(z){var aa=z.getTarget(),ba=o.byClass(aa,'commentas')!==null,ca=o.byClass(aa,'uiButton')!==null,da=o.byClass(aa,'uiSelector')!==null;x.suppressBlur=ba||ca||da;});k.listen(y,'blur',function(z,aa){if(x.interval)return;x.interval=setInterval((function(ba,ca){if(ba.suppressBlur||l.getValue(ca)||ca==document.activeElement)return;h.hide(ba);ba.suppressBlur=false;clearInterval(ba.interval);delete ba.interval;}).bind(null,x,z),100);}.bind(null,y));},attachReplyClickListenerToReply:function(w,x,y){var z=t(w);if(z){var aa=j.scry(z,'form.composerReply')[0];v.attachReplyClickListener(aa,x,y);}},attachReplyClickListenerToPost:function(w,x,y){var z=t(w);if(z){var aa=j.scry(o.byTag(z,'div'),'form.composerReply')[0];v.attachReplyClickListener(aa,x,y);}},attachReplyClickListener:function(w,x,y){if(!w)return;var z=s(x),aa=j.find(w,'textarea');k.listen(z,'click',function(ba){h.show(w);aa.focus();var ca=o.byClass(ba.target,'fbFeedbackPost').id,da=document.createElement("input");da.setAttribute("type","hidden");da.setAttribute("name","replied_to");da.setAttribute("value",ca);w.appendChild(da);setTimeout((function(){var ea=n.getInstance(aa);if(!y.isViewer&&y.isReply)if(ea){var fa=ea.getMentions();if(!fa[y.uid]&&l.getValue(aa)==='')ea.addMention(y);}else l.setValue(aa,y.text+' ');ba.preventDefault();}).bind(this),0);});},resetInput:function(w){var x=n.getInstance(w);if(x)x.reset();l.setValue(w,'');},attachPublishConfirmHandler:function(w,x,y){k.listen(w,'click',function(z){z.preventDefault();j.remove(x);window.open(y,'confirm_comment_story','scrollbars=0,resizable=no,toolbar=0,width=600,height=400');});}};e.exports=a.Feedback||v;},null);
__d("legacy:feedback",["Feedback"],function(a,b,c,d){a.Feedback=b('Feedback');},3);
__d("legacy:dom",["DOM"],function(a,b,c,d){a.DOM=b('DOM');},3);
__d("ReferrerTools",[],function(a,b,c,d,e,f){e.exports.storeAncestorOrigins=function(g){if(!location||!location.ancestorOrigins)return;for(var h=0;h<location.ancestorOrigins.length;h++){var i=document.createElement('input');i.type='hidden';i.name='ancestor_origins[]';i.value=location.ancestorOrigins.item(h);g.appendChild(i);}};},null);